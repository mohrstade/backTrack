___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "backTrack - dataLayer Event Re-Pusher",
  "categories": [
    "UTILITY"
  ],
  "brand": {
    "id": "github.com gtm-templates-mohrstade",
    "displayName": "gtm-templates-mohrstade",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Set this tag to fire once per page, on the first event with consent - to repush all previous events. This ensures your events fired before consent init are tracked.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "positive_regex",
    "displayName": "Event Whitelist Regex",
    "simpleValueType": true,
    "defaultValue": "^(?!gtm|consent|Optanon|OneTrust|cookie_consent).*$",
    "help": "Event names that match this pattern will be repushed"
  },
  {
    "type": "RADIO",
    "name": "prevent_recursive_merge",
    "displayName": "Prevent Recursive Merge (Advanced)",
    "radioItems": [
      {
        "value": false,
        "displayValue": "Off"
      },
      {
        "value": "specific",
        "displayValue": "For specific objects",
        "subParams": [
          {
            "type": "TEXT",
            "name": "comma_separated_recursive_merge",
            "displayName": "Comma separated list of objects to prevent recursive merge for",
            "simpleValueType": true,
            "textAsList": false,
            "help": "eg: ecommerce,cart.items"
          }
        ],
        "help": "List any complex data type values for which prevent_recursive_merge should be disabled"
      }
    ],
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const copyFromWindow = require('copyFromWindow');
const createQueue = require('createQueue');
const dataLayerPush = createQueue('dataLayer');
const makeString = require('makeString');
const copyFromDataLayer = require('copyFromDataLayer');
const callLater = require('callLater');
const setInWindow = require('setInWindow');

log('data =', data);

//Check if backTrack has already fired/is firing by looking for artificial/natural pushType
let alreadyFired = copyFromWindow('repushdataLayer');

if (!alreadyFired) {

    //Copy the dataLayer and filter out pushes without the event key
    let dataLayer = copyFromWindow('dataLayer').filter(key => key && key.event);

    //Starting at the beginning of the datayer
    const starting_point = 0;

    // Find the id of the current event.
    const ending_point = copyFromDataLayer('gtm.uniqueEventId');
    log({ending_point: ending_point});
    //Only use dataLayer pushes between current event and the first one.
    //log({before: dataLayer});
    dataLayer = dataLayer.filter(item => item['gtm.uniqueEventId'] < ending_point);

    //log({after: dataLayer});

    // Filter for events matching the user provided REGEX
    dataLayer = dataLayer.filter(key => key.event.match(data.positive_regex));

    //If prevent_recursive_merge is active - convert the provided string into an array
    if (data.prevent_recursive_merge === 'specific') {
        var recursive_merge_list = data.comma_separated_recursive_merge.split(',');
    }
  
     //Check if the prevent_recursive merge array is present and push nulls if any are found in events
    var recursive_merge = function(current_element){
          if (recursive_merge && recursive_merge_list && recursive_merge_list.length > 0) {
                let objects = recursive_merge_list.filter(key => typeof(current_element[key]) === 'object');
                log(objects);
                let pushobject = {};
                if (objects.length > 0) {
                    objects.forEach(object => pushobject[object] = null);
                    return pushobject;
                }
            }
            };

    //Confirm we have events to push
    if (dataLayer.length > 0) {
        dataLayer.forEach(function(element) {
            //Clear the event ID so that the events are treated as new events
            element["gtm.uniqueEventId"] = undefined;
            //Set pushType to artificial to allow for easier debugging
            element.pushType = "artificial";
            log('Repeat DataLayer Events Tag - Repushing event: ' + element.event);
            //Repush the event
            callLater(()=>
                      recursive_merge(element) && dataLayerPush(recursive_merge(element))
                      );
            callLater(()=>
                      dataLayerPush(element));
        });
            callLater(()=>dataLayerPush({
              backTrack_fired : true,
              pushType: undefined}));


    }
    setInWindow('repushdataLayer', true, false);
} else {
  log('backTrack aborted - tag has already fired');
}
// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "repushdataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedKeys",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "gtm.uniqueEventId"
              },
              {
                "type": 1,
                "string": "pushType"
              },
              {
                "type": 1,
                "string": "backTrack_fired"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: no data pushes before consent
  code: |-
    const dataLayer = [
        {
            "usc_origin": "from local storage",
            "event": "consents_initialized",
            "gtm.uniqueEventId": 1
        },
        {
            "event": "test",
            "gtm.uniqueEventId": 8
        }
    ];

    mock('copyFromWindow', key => {
      if (key === 'dataLayer'){
      return dataLayer;
      }
      if(key === 'repushdataLayer') {
        return false;
      }
    });

    mock("callLater", (callback) => {
      fail();
    });

    // Call runCode to run the template's code.
    const variableResult = runCode(mockData);

    // Verify that the variable returns a result.
    assertApi('gtmOnSuccess').wasCalled();
- name: dataLayer has pushes before consent
  code: |-
    let dataLayer = [
        {
            "event": "page_view",
            "gtm.uniqueEventId": 1
        },
        {
            "gtm.start": 1685100565459,
            "event": "gtm.js",
            "gtm.uniqueEventId": 11
        },
        {
            "event": "cookie_consent_preferences",
            "gtm.uniqueEventId": 16
        },
        {
            "event": "cookie_consent_update",
            "gtm.uniqueEventId": 30
        },
        {
            "event": "gtm.dom",
            "gtm.uniqueEventId": 35
        },
        {
            "event": "gtm.load",
            "gtm.uniqueEventId": 44
        }
    ];

    mock('copyFromWindow', key => {
      if(key === 'repushdataLayer') {
        return false;
      }
       if(key === 'dataLayer') {
        return dataLayer;
      }
    });

    mock('copyFromDataLayer', key => {
      if (key === 'gtm.uniqueEventId'){
        return 30;
      }
    });


    let pushedEvents = [];

    // Mocking the createQueue function to capture pushed events
    mock("createQueue", function () {
      return function (event) {
        log(event);
        pushedEvents.push(event);
      };
    });

    mock("callLater", (callback) => {
      callback();
    });

    log("dataLayer ",dataLayer);


    // Call runCode to run the template's code.
    runCode(mockData);

    const expectedPushedEvents = [
      // Define the expected pushed events based on your template logic
      { event: "page_view", pushType: "artificial", 'gtm.uniqueEventId': undefined },
      { backTrack_fired : true, pushType: undefined}
      // Add other expected pushed events here based on your logic
    ];
    log("expectedPushedEvents", expectedPushedEvents);
    log("pushedEvents", pushedEvents);
    assertThat(pushedEvents).isEqualTo(expectedPushedEvents);

    // Verify that the tag finished successfully.
- name: do not run template twice if backTrack_fired is set to true
  code: |-
    mock('copyFromDataLayer', key => {
      if(key === 'backTrack_fired') {
        return true;
      }
      return 30;
    });

    let dataLayer = [
        {
            "event": "page_view",
            "gtm.uniqueEventId": 1
        },
        {
            "gtm.start": 1685100565459,
            "event": "gtm.js",
            "gtm.uniqueEventId": 11
        },
        {
            "event": "cookie_consent_preferences",
            "gtm.uniqueEventId": 16
        },
        {
            "event": "cookie_consent_update",
            "gtm.uniqueEventId": 30
        },
        {
            "event": "gtm.dom",
            "gtm.uniqueEventId": 35
        },
        {
            "event": "gtm.load",
            "gtm.uniqueEventId": 44
        }
    ];


    mock('copyFromWindow', key => {
      return dataLayer;
    });

    mock("callLater", (callback) => {
      fail();
    });

    log("dataLayer ",dataLayer);


    // Call runCode to run the template's code.
    runCode(mockData);


    // Verify that the tag finished successfully.
setup: "const log = require('logToConsole');\n\nconst mockData = {\n  positive_regex:\
  \ \"^(?!gtm|consent|Optanon|OneTrust|cookie_consent).*$\" \n};"


___NOTES___

Set firing to once per page